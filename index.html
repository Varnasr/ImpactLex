<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#7C3AED">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="description" content="ImpactLex - Development Sector Terminology Dictionary with Formulae and Case Studies">
    
    <title>ImpactLex | Development Sector Dictionary</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    
    <!-- KaTeX for Math Formulae -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    
    <style>
        :root {
            /* ImpactMojo Brand Colors */
            --primary: #7C3AED;
            --primary-light: #A78BFA;
            --primary-dark: #5B21B6;
            --secondary: #0EA5E9;
            --secondary-light: #38BDF8;
            --accent: #10B981;
            --accent-light: #34D399;
            
            /* Semantic Colors */
            --success: #10B981;
            --warning: #F59E0B;
            --error: #EF4444;
            --info: #3B82F6;
            
            /* Neutrals - Light Mode */
            --bg-primary: #FAFAFA;
            --bg-secondary: #FFFFFF;
            --bg-tertiary: #F3F4F6;
            --text-primary: #111827;
            --text-secondary: #4B5563;
            --text-muted: #9CA3AF;
            --border: #E5E7EB;
            --border-light: #F3F4F6;
            
            /* Gradients */
            --gradient-primary: linear-gradient(135deg, #7C3AED 0%, #0EA5E9 100%);
            --gradient-accent: linear-gradient(135deg, #10B981 0%, #0EA5E9 100%);
            --gradient-warm: linear-gradient(135deg, #F59E0B 0%, #EF4444 100%);
            --gradient-card: linear-gradient(145deg, rgba(124, 58, 237, 0.05) 0%, rgba(14, 165, 233, 0.05) 100%);
            
            /* Shadows */
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
            --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0,0,0,0.1), 0 10px 10px -5px rgba(0,0,0,0.04);
            --shadow-glow: 0 0 20px rgba(124, 58, 237, 0.3);
            
            /* Spacing */
            --nav-height: 64px;
            --bottom-nav-height: 72px;
            --safe-area-bottom: env(safe-area-inset-bottom, 0px);
            
            /* Animation */
            --transition-fast: 150ms ease;
            --transition-normal: 250ms ease;
            --transition-slow: 350ms ease;
            
            /* Border Radius */
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
            --radius-full: 9999px;
        }
        
        /* Dark Mode */
        [data-theme="dark"] {
            --bg-primary: #0F172A;
            --bg-secondary: #1E293B;
            --bg-tertiary: #334155;
            --text-primary: #F8FAFC;
            --text-secondary: #CBD5E1;
            --text-muted: #64748B;
            --border: #334155;
            --border-light: #1E293B;
            --gradient-card: linear-gradient(145deg, rgba(124, 58, 237, 0.1) 0%, rgba(14, 165, 233, 0.1) 100%);
        }
        
        /* Reset & Base */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        html {
            font-size: 16px;
            -webkit-text-size-adjust: 100%;
            -webkit-tap-highlight-color: transparent;
            scroll-behavior: smooth;
        }
        
        body {
            font-family: 'Outfit', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            min-height: 100dvh;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* App Container */
        .app {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            min-height: 100dvh;
        }
        
        /* ========================================
           HEADER
           ======================================== */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: var(--nav-height);
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 1rem;
            z-index: 1000;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }
        
        .header-brand {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
        }
        
        .header-logo {
            width: 36px;
            height: 36px;
            background: var(--gradient-primary);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 800;
            font-size: 1.1rem;
        }
        
        .header-title {
            font-size: 1.25rem;
            font-weight: 700;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .header-subtitle {
            font-size: 0.65rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-top: -2px;
        }
        
        .header-actions {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .header-btn {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-full);
            border: none;
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-fast);
        }
        
        .header-btn:hover {
            background: var(--primary);
            color: white;
        }
        
        .header-btn svg {
            width: 20px;
            height: 20px;
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
        }
        
        /* ========================================
           MAIN CONTENT AREA
           ======================================== */
        .main-content {
            flex: 1;
            padding-top: var(--nav-height);
            padding-bottom: calc(var(--bottom-nav-height) + var(--safe-area-bottom) + 1rem);
            overflow-y: auto;
        }
        
        /* View Panels */
        .view {
            display: none;
            animation: fadeIn 0.3s ease;
        }
        
        .view.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* ========================================
           SEARCH BAR
           ======================================== */
        .search-container {
            padding: 1rem;
            position: sticky;
            top: var(--nav-height);
            background: var(--bg-primary);
            z-index: 100;
        }
        
        .search-box {
            position: relative;
        }
        
        .search-input {
            width: 100%;
            height: 52px;
            padding: 0 1rem 0 3rem;
            border: 2px solid var(--border);
            border-radius: var(--radius-lg);
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 1rem;
            font-family: inherit;
            transition: all var(--transition-fast);
        }
        
        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(124, 58, 237, 0.1);
        }
        
        .search-input::placeholder {
            color: var(--text-muted);
        }
        
        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 20px;
            color: var(--text-muted);
        }
        
        .search-clear {
            position: absolute;
            right: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            width: 32px;
            height: 32px;
            border-radius: var(--radius-full);
            border: none;
            background: var(--bg-tertiary);
            color: var(--text-muted);
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-fast);
        }
        
        .search-clear.visible {
            display: flex;
        }
        
        .search-clear:hover {
            background: var(--error);
            color: white;
        }
        
        /* Category Chips */
        .category-chips {
            display: flex;
            gap: 0.5rem;
            padding: 0 1rem 1rem;
            overflow-x: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        .category-chips::-webkit-scrollbar {
            display: none;
        }
        
        .chip {
            flex-shrink: 0;
            padding: 0.5rem 1rem;
            border-radius: var(--radius-full);
            border: 1.5px solid var(--border);
            background: var(--bg-secondary);
            color: var(--text-secondary);
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: all var(--transition-fast);
            white-space: nowrap;
        }
        
        .chip:hover {
            border-color: var(--primary-light);
            color: var(--primary);
        }
        
        .chip.active {
            background: var(--gradient-primary);
            border-color: transparent;
            color: white;
        }
        
        .chip-icon {
            margin-right: 0.35rem;
        }
        
        /* ========================================
           GLOSSARY LIST
           ======================================== */
        .glossary-list {
            padding: 0 1rem;
        }
        
        .glossary-section {
            margin-bottom: 1.5rem;
        }
        
        .glossary-letter {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.75rem;
            padding: 0 0.5rem;
        }
        
        .glossary-letter-char {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-md);
            background: var(--gradient-primary);
            color: white;
            font-weight: 700;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .glossary-letter-line {
            flex: 1;
            height: 1px;
            background: var(--border);
        }
        
        .term-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 1rem;
            margin-bottom: 0.75rem;
            cursor: pointer;
            transition: all var(--transition-fast);
        }
        
        .term-card:hover {
            border-color: var(--primary-light);
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }
        
        .term-card:active {
            transform: translateY(0);
        }
        
        .term-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }
        
        .term-title {
            font-size: 1.05rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .term-acronym {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--primary);
            background: rgba(124, 58, 237, 0.1);
            padding: 0.15rem 0.5rem;
            border-radius: var(--radius-sm);
        }
        
        .term-badges {
            display: flex;
            gap: 0.35rem;
            flex-wrap: wrap;
        }
        
        .term-badge {
            font-size: 0.65rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            padding: 0.2rem 0.5rem;
            border-radius: var(--radius-sm);
        }
        
        .badge-category {
            background: rgba(14, 165, 233, 0.1);
            color: var(--secondary);
        }
        
        .badge-formula {
            background: rgba(16, 185, 129, 0.1);
            color: var(--accent);
        }
        
        .badge-case {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }
        
        .term-preview {
            font-size: 0.9rem;
            color: var(--text-secondary);
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .term-meta {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-top: 0.75rem;
            padding-top: 0.75rem;
            border-top: 1px solid var(--border-light);
        }
        
        .term-meta-item {
            display: flex;
            align-items: center;
            gap: 0.35rem;
            font-size: 0.8rem;
            color: var(--text-muted);
        }
        
        .term-meta-item svg {
            width: 14px;
            height: 14px;
        }
        
        /* ========================================
           TERM DETAIL MODAL
           ======================================== */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all var(--transition-normal);
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            max-height: 90vh;
            max-height: 90dvh;
            background: var(--bg-secondary);
            border-radius: var(--radius-xl) var(--radius-xl) 0 0;
            z-index: 2001;
            transform: translateY(100%);
            transition: transform var(--transition-slow) cubic-bezier(0.32, 0.72, 0, 1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .modal-overlay.active .modal {
            transform: translateY(0);
        }
        
        .modal-handle {
            width: 36px;
            height: 4px;
            background: var(--border);
            border-radius: var(--radius-full);
            margin: 0.75rem auto;
            flex-shrink: 0;
        }
        
        .modal-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            padding: 0 1.25rem 1rem;
            border-bottom: 1px solid var(--border);
            flex-shrink: 0;
        }
        
        .modal-title-group {
            flex: 1;
        }
        
        .modal-term-title {
            font-size: 1.35rem;
            font-weight: 700;
            color: var(--text-primary);
            line-height: 1.3;
        }
        
        .modal-term-acronym {
            display: inline-block;
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--primary);
            background: rgba(124, 58, 237, 0.1);
            padding: 0.25rem 0.65rem;
            border-radius: var(--radius-sm);
            margin-top: 0.5rem;
        }
        
        .modal-close {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-full);
            border: none;
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            margin-left: 1rem;
        }
        
        .modal-close:hover {
            background: var(--error);
            color: white;
        }
        
        .modal-body {
            flex: 1;
            overflow-y: auto;
            padding: 1.25rem;
            -webkit-overflow-scrolling: touch;
        }
        
        .modal-section {
            margin-bottom: 1.5rem;
        }
        
        .modal-section:last-child {
            margin-bottom: 0;
        }
        
        .modal-section-title {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-muted);
            margin-bottom: 0.75rem;
        }
        
        .modal-section-title svg {
            width: 16px;
            height: 16px;
        }
        
        .modal-definition {
            font-size: 1rem;
            color: var(--text-primary);
            line-height: 1.7;
        }
        
        /* Formula Box */
        .formula-box {
            background: var(--gradient-card);
            border: 1px solid var(--border);
            border-left: 4px solid var(--accent);
            border-radius: var(--radius-md);
            padding: 1.25rem;
            overflow-x: auto;
        }
        
        .formula-title {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--accent);
            margin-bottom: 0.75rem;
        }
        
        .formula-content {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1rem;
            color: var(--text-primary);
            line-height: 2;
        }
        
        .formula-explanation {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px dashed var(--border);
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .formula-var {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            margin: 0.25rem 0;
        }
        
        .formula-var code {
            font-family: 'JetBrains Mono', monospace;
            background: var(--bg-tertiary);
            padding: 0.15rem 0.4rem;
            border-radius: var(--radius-sm);
            font-size: 0.85rem;
            color: var(--primary);
        }
        
        /* Case Study Box */
        .case-study-box {
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            overflow: hidden;
        }
        
        .case-study-header {
            background: var(--gradient-warm);
            padding: 1rem 1.25rem;
            color: white;
        }
        
        .case-study-label {
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            opacity: 0.9;
        }
        
        .case-study-title {
            font-size: 1.05rem;
            font-weight: 600;
            margin-top: 0.25rem;
        }
        
        .case-study-meta {
            display: flex;
            gap: 1rem;
            margin-top: 0.5rem;
            font-size: 0.8rem;
            opacity: 0.9;
        }
        
        .case-study-body {
            padding: 1.25rem;
        }
        
        .case-study-text {
            font-size: 0.95rem;
            color: var(--text-secondary);
            line-height: 1.7;
        }
        
        .case-study-highlight {
            background: rgba(245, 158, 11, 0.1);
            border-left: 3px solid var(--warning);
            padding: 0.75rem 1rem;
            margin-top: 1rem;
            border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
        }
        
        .case-study-highlight-title {
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            color: var(--warning);
            margin-bottom: 0.35rem;
        }
        
        /* Related Terms */
        .related-terms {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        
        .related-term {
            padding: 0.5rem 0.85rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: var(--radius-full);
            font-size: 0.85rem;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all var(--transition-fast);
        }
        
        .related-term:hover {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
        }
        
        /* Sources */
        .sources-list {
            list-style: none;
        }
        
        .source-item {
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
            padding: 0.5rem 0;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        
        .source-item::before {
            content: '‚Ä¢';
            color: var(--primary);
            font-weight: bold;
        }
        
        .source-link {
            color: var(--secondary);
            text-decoration: none;
        }
        
        .source-link:hover {
            text-decoration: underline;
        }
        
        /* Modal Actions */
        .modal-actions {
            display: flex;
            gap: 0.75rem;
            padding: 1rem 1.25rem;
            border-top: 1px solid var(--border);
            flex-shrink: 0;
            background: var(--bg-secondary);
        }
        
        .modal-btn {
            flex: 1;
            height: 48px;
            border-radius: var(--radius-md);
            border: none;
            font-size: 0.95rem;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            transition: all var(--transition-fast);
        }
        
        .modal-btn svg {
            width: 18px;
            height: 18px;
        }
        
        .modal-btn-primary {
            background: var(--gradient-primary);
            color: white;
        }
        
        .modal-btn-primary:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }
        
        .modal-btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            border: 1px solid var(--border);
        }
        
        .modal-btn-secondary:hover {
            border-color: var(--primary);
            color: var(--primary);
        }
        
        .modal-btn-secondary.bookmarked {
            background: rgba(124, 58, 237, 0.1);
            border-color: var(--primary);
            color: var(--primary);
        }
        
        /* ========================================
           FORMULAE VIEW
           ======================================== */
        .formula-grid {
            display: grid;
            gap: 1rem;
            padding: 1rem;
        }
        
        .formula-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            overflow: hidden;
            cursor: pointer;
            transition: all var(--transition-fast);
        }
        
        .formula-card:hover {
            border-color: var(--accent);
            box-shadow: var(--shadow-md);
        }
        
        .formula-card-header {
            background: var(--gradient-accent);
            padding: 1rem;
            color: white;
        }
        
        .formula-card-category {
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            opacity: 0.9;
        }
        
        .formula-card-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-top: 0.25rem;
        }
        
        .formula-card-body {
            padding: 1rem;
        }
        
        .formula-card-formula {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.95rem;
            color: var(--text-primary);
            background: var(--bg-tertiary);
            padding: 0.75rem;
            border-radius: var(--radius-sm);
            overflow-x: auto;
            text-align: center;
        }
        
        .formula-card-desc {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-top: 0.75rem;
            line-height: 1.5;
        }
        
        /* ========================================
           CASE STUDIES VIEW
           ======================================== */
        .case-studies-list {
            padding: 1rem;
        }
        
        .case-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            margin-bottom: 1rem;
            overflow: hidden;
            cursor: pointer;
            transition: all var(--transition-fast);
        }
        
        .case-card:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
        }
        
        .case-card-image {
            height: 140px;
            background: var(--gradient-warm);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 3rem;
        }
        
        .case-card-content {
            padding: 1rem;
        }
        
        .case-card-tags {
            display: flex;
            gap: 0.35rem;
            margin-bottom: 0.5rem;
        }
        
        .case-card-tag {
            font-size: 0.65rem;
            font-weight: 600;
            text-transform: uppercase;
            padding: 0.2rem 0.5rem;
            border-radius: var(--radius-sm);
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }
        
        .case-card-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }
        
        .case-card-meta {
            display: flex;
            gap: 1rem;
            font-size: 0.8rem;
            color: var(--text-muted);
        }
        
        .case-card-excerpt {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: 0.75rem;
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        /* ========================================
           BOOKMARKS VIEW
           ======================================== */
        .bookmarks-header {
            padding: 1.5rem 1rem 1rem;
        }
        
        .bookmarks-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
        }
        
        .bookmarks-subtitle {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-top: 0.25rem;
        }
        
        .bookmarks-actions {
            display: flex;
            gap: 0.75rem;
            margin-top: 1rem;
        }
        
        .bookmarks-empty {
            text-align: center;
            padding: 4rem 2rem;
        }
        
        .bookmarks-empty-icon {
            width: 80px;
            height: 80px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
        }
        
        .bookmarks-empty-icon svg {
            width: 40px;
            height: 40px;
            color: var(--text-muted);
        }
        
        .bookmarks-empty-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }
        
        .bookmarks-empty-text {
            font-size: 0.95rem;
            color: var(--text-muted);
        }
        
        /* ========================================
           BOTTOM NAVIGATION
           ======================================== */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: calc(var(--bottom-nav-height) + var(--safe-area-bottom));
            padding-bottom: var(--safe-area-bottom);
            background: var(--bg-secondary);
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: space-around;
            align-items: center;
            z-index: 1000;
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.25rem;
            padding: 0.5rem 1rem;
            border-radius: var(--radius-md);
            color: var(--text-muted);
            text-decoration: none;
            transition: all var(--transition-fast);
            cursor: pointer;
            border: none;
            background: none;
            font-family: inherit;
        }
        
        .nav-item:hover {
            color: var(--text-secondary);
        }
        
        .nav-item.active {
            color: var(--primary);
        }
        
        .nav-item.active .nav-icon {
            background: rgba(124, 58, 237, 0.1);
        }
        
        .nav-icon {
            width: 40px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-md);
            transition: background var(--transition-fast);
        }
        
        .nav-icon svg {
            width: 22px;
            height: 22px;
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
        }
        
        .nav-label {
            font-size: 0.7rem;
            font-weight: 600;
        }
        
        .nav-badge {
            position: absolute;
            top: 0;
            right: 0.5rem;
            min-width: 18px;
            height: 18px;
            background: var(--error);
            color: white;
            font-size: 0.65rem;
            font-weight: 700;
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 5px;
        }
        
        /* ========================================
           UTILITIES
           ======================================== */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        .text-gradient {
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        /* Toast Notifications */
        .toast-container {
            position: fixed;
            bottom: calc(var(--bottom-nav-height) + var(--safe-area-bottom) + 1rem);
            left: 50%;
            transform: translateX(-50%);
            z-index: 3000;
        }
        
        .toast {
            background: var(--text-primary);
            color: var(--bg-primary);
            padding: 0.75rem 1.25rem;
            border-radius: var(--radius-full);
            font-size: 0.9rem;
            font-weight: 500;
            box-shadow: var(--shadow-xl);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            animation: toastIn 0.3s ease;
        }
        
        .toast.hiding {
            animation: toastOut 0.3s ease forwards;
        }
        
        @keyframes toastIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes toastOut {
            from { opacity: 1; transform: translateY(0); }
            to { opacity: 0; transform: translateY(20px); }
        }
        
        /* Loading Spinner */
        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top-color: var(--primary);
            border-radius: var(--radius-full);
            animation: spin 0.8s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Term of the Day */
        .term-of-day {
            margin: 1rem;
            padding: 1.25rem;
            background: var(--gradient-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            position: relative;
            overflow: hidden;
        }
        
        .term-of-day::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--gradient-primary);
        }
        
        .term-of-day-label {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--primary);
            margin-bottom: 0.75rem;
        }
        
        .term-of-day-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }
        
        .term-of-day-preview {
            font-size: 0.95rem;
            color: var(--text-secondary);
            line-height: 1.6;
        }
        
        .term-of-day-cta {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            margin-top: 1rem;
            color: var(--primary);
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
        }
        
        .term-of-day-cta:hover {
            text-decoration: underline;
        }
        
        /* Stats Bar */
        .stats-bar {
            display: flex;
            justify-content: space-around;
            padding: 1rem;
            margin: 0 1rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .stat-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        /* Tablet and Desktop Enhancements */
        @media (min-width: 768px) {
            .main-content {
                max-width: 800px;
                margin: 0 auto;
            }
            
            .modal {
                max-width: 600px;
                left: 50%;
                transform: translateX(-50%) translateY(100%);
                border-radius: var(--radius-xl);
                margin-bottom: 2rem;
                max-height: 85vh;
            }
            
            .modal-overlay.active .modal {
                transform: translateX(-50%) translateY(0);
            }
            
            .formula-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .bottom-nav {
                max-width: 500px;
                left: 50%;
                transform: translateX(-50%);
                border-radius: var(--radius-xl) var(--radius-xl) 0 0;
                border: 1px solid var(--border);
                border-bottom: none;
            }
        }
        
        /* Install Banner */
        .install-banner {
            position: fixed;
            bottom: calc(var(--bottom-nav-height) + var(--safe-area-bottom) + 0.75rem);
            left: 1rem;
            right: 1rem;
            background: var(--gradient-primary);
            color: white;
            padding: 1rem;
            border-radius: var(--radius-lg);
            display: none;
            align-items: center;
            gap: 1rem;
            box-shadow: var(--shadow-xl);
            z-index: 999;
        }
        
        .install-banner.visible {
            display: flex;
        }
        
        .install-banner-content {
            flex: 1;
        }
        
        .install-banner-title {
            font-weight: 700;
            font-size: 1rem;
        }
        
        .install-banner-text {
            font-size: 0.85rem;
            opacity: 0.9;
        }
        
        .install-banner-btn {
            padding: 0.6rem 1.25rem;
            background: white;
            color: var(--primary);
            border: none;
            border-radius: var(--radius-md);
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            white-space: nowrap;
        }
        
        .install-banner-close {
            width: 32px;
            height: 32px;
            border-radius: var(--radius-full);
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>
<body>
    <div class="app">
        <!-- Header -->
        <header class="header">
            <a href="#" class="header-brand" onclick="navigateTo('glossary'); return false;">
                <div class="header-logo">IL</div>
                <div>
                    <div class="header-title">ImpactLex</div>
                    <div class="header-subtitle">Development Dictionary</div>
                </div>
            </a>
            <div class="header-actions">
                <button class="header-btn" onclick="toggleTheme()" title="Toggle theme" aria-label="Toggle dark mode">
                    <svg class="theme-icon-light" viewBox="0 0 24 24"><circle cx="12" cy="12" r="5"/><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/></svg>
                    <svg class="theme-icon-dark" style="display:none" viewBox="0 0 24 24"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
                </button>
                <a href="https://impactmojo.in" target="_blank" class="header-btn" title="ImpactMojo" aria-label="Go to ImpactMojo">
                    <svg viewBox="0 0 24 24"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
                </a>
            </div>
        </header>
        
        <!-- Main Content -->
        <main class="main-content">
            <!-- Glossary View -->
            <div id="glossary-view" class="view active">
                <div class="search-container">
                    <div class="search-box">
                        <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/>
                        </svg>
                        <input type="text" class="search-input" id="searchInput" placeholder="Search terms, acronyms, concepts..." autocomplete="off">
                        <button class="search-clear" id="searchClear" aria-label="Clear search">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
                            </svg>
                        </button>
                    </div>
                </div>
                
                <div class="category-chips" id="categoryChips">
                    <button class="chip active" data-category="all">
                        <span class="chip-icon">üìö</span>All
                    </button>
                    <button class="chip" data-category="meal">
                        <span class="chip-icon">üìä</span>MEAL
                    </button>
                    <button class="chip" data-category="toc">
                        <span class="chip-icon">üéØ</span>Theory of Change
                    </button>
                    <button class="chip" data-category="gender">
                        <span class="chip-icon">‚öñÔ∏è</span>Gender
                    </button>
                    <button class="chip" data-category="research">
                        <span class="chip-icon">üî¨</span>Research Methods
                    </button>
                    <button class="chip" data-category="economics">
                        <span class="chip-icon">üí∞</span>Dev Economics
                    </button>
                    <button class="chip" data-category="governance">
                        <span class="chip-icon">üèõÔ∏è</span>Governance
                    </button>
                    <button class="chip" data-category="climate">
                        <span class="chip-icon">üåç</span>Climate
                    </button>
                </div>
                
                <!-- Term of the Day -->
                <div class="term-of-day" id="termOfDay">
                    <div class="term-of-day-label">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
                        </svg>
                        Term of the Day
                    </div>
                    <div class="term-of-day-title" id="todTitle">Loading...</div>
                    <div class="term-of-day-preview" id="todPreview">Loading today's featured term...</div>
                    <div class="term-of-day-cta" onclick="openTermOfDay()">
                        Learn more ‚Üí
                    </div>
                </div>
                
                <!-- Stats Bar -->
                <div class="stats-bar">
                    <div class="stat-item">
                        <div class="stat-value" id="statTerms">0</div>
                        <div class="stat-label">Terms</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="statFormulae">0</div>
                        <div class="stat-label">Formulae</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="statCases">0</div>
                        <div class="stat-label">Case Studies</div>
                    </div>
                </div>
                
                <!-- Glossary List -->
                <div class="glossary-list" id="glossaryList">
                    <!-- Populated by JavaScript -->
                </div>
            </div>
            
            <!-- Formulae View -->
            <div id="formulae-view" class="view">
                <div class="search-container">
                    <div class="search-box">
                        <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/>
                        </svg>
                        <input type="text" class="search-input" id="formulaSearchInput" placeholder="Search formulae..." autocomplete="off">
                    </div>
                </div>
                
                <div class="formula-grid" id="formulaGrid">
                    <!-- Populated by JavaScript -->
                </div>
            </div>
            
            <!-- Case Studies View -->
            <div id="cases-view" class="view">
                <div class="search-container">
                    <div class="search-box">
                        <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/>
                        </svg>
                        <input type="text" class="search-input" id="caseSearchInput" placeholder="Search case studies..." autocomplete="off">
                    </div>
                </div>
                
                <div class="category-chips" id="caseChips">
                    <button class="chip active" data-category="all">All Regions</button>
                    <button class="chip" data-category="south-asia">South Asia</button>
                    <button class="chip" data-category="africa">Africa</button>
                    <button class="chip" data-category="latin-america">Latin America</button>
                    <button class="chip" data-category="global">Global</button>
                </div>
                
                <div class="case-studies-list" id="caseStudiesList">
                    <!-- Populated by JavaScript -->
                </div>
            </div>
            
            <!-- Bookmarks View -->
            <div id="bookmarks-view" class="view">
                <div class="bookmarks-header">
                    <h1 class="bookmarks-title">Your Bookmarks</h1>
                    <p class="bookmarks-subtitle">Saved terms for quick reference</p>
                    <div class="bookmarks-actions">
                        <button class="modal-btn modal-btn-secondary" onclick="exportBookmarks()" style="flex:1; height:42px;">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/>
                            </svg>
                            Export CSV
                        </button>
                        <button class="modal-btn modal-btn-secondary" onclick="clearAllBookmarks()" style="flex:1; height:42px;">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                            </svg>
                            Clear All
                        </button>
                    </div>
                </div>
                
                <div class="glossary-list" id="bookmarksList">
                    <!-- Populated by JavaScript or shows empty state -->
                </div>
            </div>
        </main>
        
        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <button class="nav-item active" onclick="navigateTo('glossary')" data-view="glossary">
                <div class="nav-icon">
                    <svg viewBox="0 0 24 24"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg>
                </div>
                <span class="nav-label">Glossary</span>
            </button>
            <button class="nav-item" onclick="navigateTo('formulae')" data-view="formulae">
                <div class="nav-icon">
                    <svg viewBox="0 0 24 24"><path d="M4 4h6v6H4zM14 4h6v6h-6zM4 14h6v6H4z"/><path d="M17 14v8M14 17h6"/></svg>
                </div>
                <span class="nav-label">Formulae</span>
            </button>
            <button class="nav-item" onclick="navigateTo('cases')" data-view="cases">
                <div class="nav-icon">
                    <svg viewBox="0 0 24 24"><rect x="2" y="7" width="20" height="14" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></svg>
                </div>
                <span class="nav-label">Cases</span>
            </button>
            <button class="nav-item" onclick="navigateTo('bookmarks')" data-view="bookmarks">
                <div class="nav-icon" style="position:relative;">
                    <svg viewBox="0 0 24 24"><path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"/></svg>
                    <span class="nav-badge" id="bookmarkBadge" style="display:none;">0</span>
                </div>
                <span class="nav-label">Saved</span>
            </button>
        </nav>
        
        <!-- Term Detail Modal -->
        <div class="modal-overlay" id="termModal">
            <div class="modal">
                <div class="modal-handle"></div>
                <div class="modal-header">
                    <div class="modal-title-group">
                        <h2 class="modal-term-title" id="modalTitle">Term Title</h2>
                        <span class="modal-term-acronym" id="modalAcronym" style="display:none;"></span>
                    </div>
                    <button class="modal-close" onclick="closeModal()" aria-label="Close">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
                        </svg>
                    </button>
                </div>
                <div class="modal-body" id="modalBody">
                    <!-- Dynamic content -->
                </div>
                <div class="modal-actions">
                    <button class="modal-btn modal-btn-secondary" id="bookmarkBtn" onclick="toggleBookmark()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"/>
                        </svg>
                        <span id="bookmarkBtnText">Save</span>
                    </button>
                    <button class="modal-btn modal-btn-primary" onclick="shareTerm()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/>
                        </svg>
                        Share
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Toast Container -->
        <div class="toast-container" id="toastContainer"></div>
        
        <!-- Install Banner -->
        <div class="install-banner" id="installBanner">
            <div class="install-banner-content">
                <div class="install-banner-title">Install ImpactLex</div>
                <div class="install-banner-text">Add to home screen for offline access</div>
            </div>
            <button class="install-banner-btn" onclick="installApp()">Install</button>
            <button class="install-banner-close" onclick="dismissInstall()">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
            </button>
        </div>
    </div>

    <script>
        // ============================================================
        // IMPACTLEX - DEVELOPMENT SECTOR TERMINOLOGY APP
        // ============================================================
        
        // ============================================================
        // DATA: GLOSSARY TERMS WITH DEFINITIONS, FORMULAE, CASE STUDIES
        // ============================================================
        const GLOSSARY_DATA = [
            // MEAL Terms
            {
                id: 'attribution',
                term: 'Attribution',
                acronym: null,
                category: 'meal',
                definition: 'The process of establishing a causal link between observed outcomes and a specific intervention, demonstrating that the intervention directly caused the observed changes rather than other factors. Attribution requires rigorous counterfactual analysis to isolate the impact of the intervention from confounding variables.',
                formula: null,
                caseStudy: null,
                relatedTerms: ['Contribution', 'Counterfactual', 'Impact Evaluation'],
                sources: ['OECD-DAC Evaluation Criteria', 'World Bank IEG Guidelines']
            },
            {
                id: 'contribution',
                term: 'Contribution Analysis',
                acronym: null,
                category: 'meal',
                definition: 'An approach to causal inference that assesses how an intervention contributed to observed outcomes within a complex system, acknowledging that multiple factors may have influenced results. Unlike attribution, contribution analysis accepts that interventions rarely act in isolation and seeks to understand the relative role of the intervention among various causal factors.',
                formula: null,
                caseStudy: {
                    title: 'DFID Bangladesh Chars Livelihoods Programme',
                    region: 'South Asia',
                    year: 2010,
                    summary: 'Used contribution analysis to assess how cash transfers, asset provision, and social protection worked together to reduce extreme poverty in char (riverine island) communities. The approach helped identify that community-level factors and seasonal timing were critical moderating variables.',
                    keyFinding: 'Contribution analysis revealed that 63% of poverty reduction could be attributed to direct programme activities, while community adaptation mechanisms contributed an additional 22%.'
                },
                relatedTerms: ['Attribution', 'Theory of Change', 'Outcome Harvesting'],
                sources: ['John Mayne (2008)', 'DFID Evaluation Reports']
            },
            {
                id: 'counterfactual',
                term: 'Counterfactual',
                acronym: null,
                category: 'research',
                definition: 'A hypothetical scenario representing what would have happened to beneficiaries in the absence of the intervention. The counterfactual is never directly observable and must be estimated through comparison groups, statistical methods, or simulation. It forms the foundation of impact evaluation methodology.',
                formula: {
                    name: 'Average Treatment Effect',
                    expression: 'ATE = E[Y‚ÇÅ - Y‚ÇÄ] = E[Y‚ÇÅ] - E[Y‚ÇÄ]',
                    explanation: 'Where Y‚ÇÅ is the outcome with treatment and Y‚ÇÄ is the counterfactual outcome without treatment. The fundamental problem of causal inference is that we can never observe both Y‚ÇÅ and Y‚ÇÄ for the same unit.',
                    variables: [
                        { symbol: 'Y‚ÇÅ', meaning: 'Outcome under treatment condition' },
                        { symbol: 'Y‚ÇÄ', meaning: 'Outcome under control condition (counterfactual)' },
                        { symbol: 'E[¬∑]', meaning: 'Expected value (population average)' }
                    ]
                },
                caseStudy: null,
                relatedTerms: ['RCT', 'Difference-in-Differences', 'Propensity Score Matching'],
                sources: ['Angrist & Pischke (2009)', 'J-PAL Research Resources']
            },
            {
                id: 'did',
                term: 'Difference-in-Differences',
                acronym: 'DiD',
                category: 'research',
                definition: 'A quasi-experimental research design that compares changes in outcomes over time between a treatment group and a control group. DiD estimates causal effects by removing time-invariant unobserved heterogeneity and common time trends, under the assumption of parallel trends in the absence of treatment.',
                formula: {
                    name: 'DiD Estimator',
                    expression: 'DiD = (»≤_T,post - »≤_T,pre) - (»≤_C,post - »≤_C,pre)',
                    explanation: 'The estimator calculates the difference in the before-after change between treatment and control groups. This removes both pre-existing differences between groups and common time trends.',
                    variables: [
                        { symbol: '»≤_T,post', meaning: 'Mean outcome for treatment group after intervention' },
                        { symbol: '»≤_T,pre', meaning: 'Mean outcome for treatment group before intervention' },
                        { symbol: '»≤_C,post', meaning: 'Mean outcome for control group after intervention' },
                        { symbol: '»≤_C,pre', meaning: 'Mean outcome for control group before intervention' }
                    ]
                },
                caseStudy: {
                    title: 'Card & Krueger Minimum Wage Study',
                    region: 'Global',
                    year: 1994,
                    summary: 'The seminal DiD study compared employment in fast-food restaurants in New Jersey (where minimum wage increased) and Pennsylvania (where it did not) before and after the policy change.',
                    keyFinding: 'Contrary to classical predictions, employment did not decrease following the minimum wage increase, challenging conventional economic theory.'
                },
                relatedTerms: ['Counterfactual', 'Parallel Trends', 'Fixed Effects'],
                sources: ['Card & Krueger (1994)', 'Cunningham (2021) Causal Inference: The Mixtape']
            },
            {
                id: 'indicator',
                term: 'Indicator',
                acronym: null,
                category: 'meal',
                definition: 'A quantitative or qualitative variable that provides a simple and reliable means to measure achievement, reflect changes connected to an intervention, or help assess the performance of a development actor. Good indicators are SMART: Specific, Measurable, Achievable, Relevant, and Time-bound.',
                formula: null,
                caseStudy: null,
                relatedTerms: ['Baseline', 'Target', 'Results Framework', 'Logframe'],
                sources: ['UNDP Handbook on M&E', 'USAID Indicator Guidelines']
            },
            {
                id: 'logframe',
                term: 'Logical Framework',
                acronym: 'LogFrame',
                category: 'meal',
                definition: 'A management tool used to improve the design of interventions, most often at the project level. It involves identifying strategic elements (inputs, outputs, outcomes, impact) and their causal relationships, indicators, and assumptions that may affect success. The logframe presents this information in a 4x4 matrix format.',
                formula: null,
                caseStudy: null,
                relatedTerms: ['Results Framework', 'Theory of Change', 'Indicator'],
                sources: ['USAID LogFrame Guidance', 'European Commission Guidelines']
            },
            {
                id: 'outcome',
                term: 'Outcome',
                acronym: null,
                category: 'meal',
                definition: 'The likely or achieved short-term and medium-term effects of an intervention\'s outputs. Outcomes represent changes in behaviour, practices, performance, or conditions among target populations that are directly influenced by the intervention\'s outputs but not fully within the intervention\'s control.',
                formula: null,
                caseStudy: null,
                relatedTerms: ['Output', 'Impact', 'Results Chain'],
                sources: ['OECD-DAC Glossary', 'UNDP Results-Based Management']
            },
            {
                id: 'output',
                term: 'Output',
                acronym: null,
                category: 'meal',
                definition: 'The products, goods, and services that result from a development intervention. Outputs are fully within the implementing organization\'s control and represent the direct deliverables of programme activities. They are necessary but not sufficient conditions for achieving outcomes.',
                formula: null,
                caseStudy: null,
                relatedTerms: ['Outcome', 'Activity', 'Results Chain'],
                sources: ['OECD-DAC Glossary', 'World Bank Results Framework']
            },
            {
                id: 'rct',
                term: 'Randomized Controlled Trial',
                acronym: 'RCT',
                category: 'research',
                definition: 'An experimental research design in which participants are randomly assigned to treatment and control groups, ensuring that any systematic differences in outcomes can be attributed to the intervention rather than pre-existing differences between groups. RCTs are considered the gold standard for establishing causal effects.',
                formula: {
                    name: 'Intent-to-Treat Effect',
                    expression: 'ITT = E[Y|Z=1] - E[Y|Z=0]',
                    explanation: 'The ITT effect compares average outcomes between those assigned to treatment versus control, regardless of whether they actually received treatment. This preserves the benefits of randomization.',
                    variables: [
                        { symbol: 'Y', meaning: 'Outcome variable of interest' },
                        { symbol: 'Z', meaning: 'Treatment assignment (1=assigned to treatment, 0=assigned to control)' },
                        { symbol: 'E[¬∑|¬∑]', meaning: 'Conditional expectation' }
                    ]
                },
                caseStudy: {
                    title: 'Progresa/Oportunidades Conditional Cash Transfer',
                    region: 'Latin America',
                    year: 1997,
                    summary: 'One of the most influential RCTs in development economics, randomizing the rollout of Mexico\'s conditional cash transfer programme across 506 communities to measure effects on education, health, and nutrition.',
                    keyFinding: 'The RCT showed significant increases in school enrollment (particularly for girls), healthcare visits, and child nutrition, establishing the evidence base for CCT programmes worldwide.'
                },
                relatedTerms: ['Counterfactual', 'Internal Validity', 'Statistical Power'],
                sources: ['J-PAL Research Resources', 'Duflo, Glennerster & Kremer (2007)']
            },
            {
                id: 'toc',
                term: 'Theory of Change',
                acronym: 'ToC',
                category: 'toc',
                definition: 'A comprehensive description and illustration of how and why a desired change is expected to happen in a particular context. It maps out the causal pathways from activities to long-term goals, making explicit the assumptions underlying each step and the evidence supporting those assumptions.',
                formula: null,
                caseStudy: {
                    title: 'Building Resilience and Adaptation to Climate Extremes and Disasters (BRACED)',
                    region: 'Africa',
                    year: 2015,
                    summary: 'DFID\'s ¬£140 million programme used Theory of Change as a core methodology across 15 NGO-led projects in the Sahel and South/Southeast Asia. Each project developed context-specific ToCs that were regularly tested and updated.',
                    keyFinding: 'The ToC approach enabled adaptive management, with 73% of projects modifying their intervention strategies based on evidence that emerged during implementation.'
                },
                relatedTerms: ['Logframe', 'Results Chain', 'Assumptions'],
                sources: ['Weiss (1995)', 'USAID Theory of Change Resources']
            },
            {
                id: 'triangulation',
                term: 'Triangulation',
                acronym: null,
                category: 'research',
                definition: 'The use of multiple methods, data sources, theories, or investigators to develop a comprehensive understanding of phenomena. In evaluation, triangulation enhances credibility and validity by showing that findings are consistent across different approaches, or by explaining why differences exist.',
                formula: null,
                caseStudy: null,
                relatedTerms: ['Mixed Methods', 'Validity', 'Data Collection'],
                sources: ['Denzin (1978)', 'UNODC Evaluation Guidelines']
            },
            
            // Gender Terms
            {
                id: 'gba',
                term: 'Gender-Based Analysis',
                acronym: 'GBA+',
                category: 'gender',
                definition: 'An analytical framework that considers how gender and other intersecting identity factors influence the differential impacts of policies, programmes, and services on diverse populations. The "plus" acknowledges that gender intersects with other dimensions including race, ethnicity, religion, age, disability, and socioeconomic status.',
                formula: null,
                caseStudy: null,
                relatedTerms: ['Intersectionality', 'Gender Mainstreaming', 'Sex-Disaggregated Data'],
                sources: ['Government of Canada GBA+ Framework', 'UN Women Resources']
            },
            {
                id: 'intersectionality',
                term: 'Intersectionality',
                acronym: null,
                category: 'gender',
                definition: 'A theoretical framework originally developed by Kimberl√© Crenshaw recognizing that social categorizations such as gender, race, class, and other aspects of identity create overlapping and interdependent systems of discrimination or disadvantage. Intersectionality reveals how multiple forms of oppression compound and create unique experiences of marginalization.',
                formula: null,
                caseStudy: {
                    title: 'SEWA Self-Employed Women\'s Association',
                    region: 'South Asia',
                    year: 1972,
                    summary: 'SEWA\'s organizing model explicitly addresses intersecting vulnerabilities of women who are poor, self-employed, and often from marginalized castes. Their approach integrates economic empowerment with social protection and political voice.',
                    keyFinding: 'SEWA\'s intersectional approach has reached over 2 million members, demonstrating that addressing multiple dimensions of marginalization simultaneously produces stronger outcomes than single-issue interventions.'
                },
                relatedTerms: ['Gender-Based Analysis', 'Social Inclusion', 'Marginalization'],
                sources: ['Crenshaw (1989)', 'UN Women Intersectionality Resource Guide']
            },
            {
                id: 'gm',
                term: 'Gender Mainstreaming',
                acronym: null,
                category: 'gender',
                definition: 'A strategy for making women\'s as well as men\'s concerns and experiences an integral dimension of design, implementation, monitoring, and evaluation of policies and programmes in all political, economic, and societal spheres, so that women and men benefit equally and inequality is not perpetuated.',
                formula: null,
                caseStudy: null,
                relatedTerms: ['GBA+', 'Gender Equality', 'Sex-Disaggregated Data'],
                sources: ['ECOSOC 1997/2', 'UN Women Gender Mainstreaming']
            },
            {
                id: 'unpaid-care',
                term: 'Unpaid Care Work',
                acronym: null,
                category: 'gender',
                definition: 'Non-remunerated work performed in the household or community including domestic work (cooking, cleaning), care of persons (children, elderly, ill family members), and community volunteer work. This work disproportionately falls on women and girls, constraining their time for education, paid employment, and leisure.',
                formula: {
                    name: 'Time Poverty Measure',
                    expression: 'TP = (Work_paid + Work_unpaid) > T_threshold',
                    explanation: 'An individual is time poor if total work hours exceed a threshold (often 10.5 hours/day). Women are 2-10 times more likely to be time poor due to unpaid care responsibilities.',
                    variables: [
                        { symbol: 'Work_paid', meaning: 'Hours spent in paid employment' },
                        { symbol: 'Work_unpaid', meaning: 'Hours spent in unpaid care and domestic work' },
                        { symbol: 'T_threshold', meaning: 'Time poverty threshold (varies by methodology)' }
                    ]
                },
                caseStudy: null,
                relatedTerms: ['Care Economy', 'Time Use Survey', 'Gender Division of Labour'],
                sources: ['ILO Care Work and Care Jobs Report', 'Oxfam Time to Care Report']
            },
            
            // Development Economics Terms
            {
                id: 'gini',
                term: 'Gini Coefficient',
                acronym: null,
                category: 'economics',
                definition: 'A statistical measure of income or wealth inequality within a population, ranging from 0 (perfect equality, where everyone has the same income) to 1 (perfect inequality, where one person has all the income). The Gini coefficient is derived from the Lorenz curve and is the most commonly used measure of economic inequality.',
                formula: {
                    name: 'Gini Coefficient',
                    expression: 'G = (2 √ó ‚àë·µ¢ i √ó x·µ¢) / (n √ó ‚àë·µ¢ x·µ¢) - (n + 1) / n',
                    explanation: 'For income data sorted in ascending order, this formula calculates the area between the Lorenz curve and the line of perfect equality. A simpler interpretation: G = A / (A + B) where A is the area between the equality line and Lorenz curve.',
                    variables: [
                        { symbol: 'x·µ¢', meaning: 'Income of individual i (sorted ascending)' },
                        { symbol: 'n', meaning: 'Total number of individuals' },
                        { symbol: 'i', meaning: 'Rank of individual in income distribution' }
                    ]
                },
                caseStudy: null,
                relatedTerms: ['Lorenz Curve', 'Poverty', 'Income Distribution'],
                sources: ['World Bank Development Indicators', 'Deaton (1997)']
            },
            {
                id: 'hdi',
                term: 'Human Development Index',
                acronym: 'HDI',
                category: 'economics',
                definition: 'A composite index developed by UNDP measuring average achievement in three basic dimensions of human development: a long and healthy life (life expectancy at birth), knowledge (mean and expected years of schooling), and a decent standard of living (GNI per capita in PPP terms). The HDI ranges from 0 to 1, with higher values indicating higher human development.',
                formula: {
                    name: 'HDI Calculation',
                    expression: 'HDI = (I_health √ó I_education √ó I_income)^(1/3)',
                    explanation: 'The HDI is the geometric mean of normalized indices for each dimension. This formulation means low achievement in one dimension cannot be fully compensated by high achievement in another.',
                    variables: [
                        { symbol: 'I_health', meaning: 'Life expectancy index: (LE - 20) / (85 - 20)' },
                        { symbol: 'I_education', meaning: 'Education index: (MYSI + EYSI) / 2' },
                        { symbol: 'I_income', meaning: 'Income index: (ln(GNIpc) - ln(100)) / (ln(75000) - ln(100))' }
                    ]
                },
                caseStudy: null,
                relatedTerms: ['Multidimensional Poverty Index', 'Capability Approach', 'Well-being'],
                sources: ['UNDP Human Development Reports', 'Sen (1999)']
            },
            {
                id: 'mpi',
                term: 'Multidimensional Poverty Index',
                acronym: 'MPI',
                category: 'economics',
                definition: 'A measure of poverty that captures simultaneous deprivations across health, education, and living standards dimensions. Unlike income poverty measures, MPI identifies who is poor and which deprivations they face, enabling more targeted policy responses. A person is MPI poor if deprived in at least one-third of weighted indicators.',
                formula: {
                    name: 'MPI Calculation',
                    expression: 'MPI = H √ó A',
                    explanation: 'MPI is the product of multidimensional poverty incidence (H) and intensity (A). This captures both how many people are poor and how poor they are.',
                    variables: [
                        { symbol: 'H', meaning: 'Incidence: proportion of population who are MPI poor' },
                        { symbol: 'A', meaning: 'Intensity: average deprivation score among the poor' }
                    ]
                },
                caseStudy: {
                    title: 'India\'s Multidimensional Poverty Reduction',
                    region: 'South Asia',
                    year: 2023,
                    summary: 'NITI Aayog\'s national MPI showed that 135 million people escaped multidimensional poverty between 2015-16 and 2019-21, with the fastest reductions in nutrition, cooking fuel, and sanitation indicators.',
                    keyFinding: 'State-level analysis revealed that Uttar Pradesh, Bihar, and Madhya Pradesh (large, historically poor states) recorded the fastest reductions, narrowing interstate inequality in deprivations.'
                },
                relatedTerms: ['HDI', 'Poverty Line', 'Capability Approach'],
                sources: ['UNDP-OPHI Global MPI', 'Alkire & Foster (2011)']
            },
            {
                id: 'ppp',
                term: 'Purchasing Power Parity',
                acronym: 'PPP',
                category: 'economics',
                definition: 'An economic theory and measurement method that adjusts exchange rates to equalize the purchasing power of different currencies. PPP-adjusted figures enable meaningful cross-country comparisons of income, poverty, and living standards by accounting for differences in price levels between countries.',
                formula: {
                    name: 'PPP Conversion',
                    expression: 'Income_PPP = Income_local / PPP_factor',
                    explanation: 'PPP factors convert local currency to international dollars, which have the same purchasing power as USD in the United States. The international poverty line ($2.15/day in 2017 PPP) uses this methodology.',
                    variables: [
                        { symbol: 'Income_local', meaning: 'Income in local currency' },
                        { symbol: 'PPP_factor', meaning: 'PPP conversion factor (local currency per international dollar)' }
                    ]
                },
                caseStudy: null,
                relatedTerms: ['Exchange Rate', 'Poverty Line', 'GNI per capita'],
                sources: ['World Bank International Comparison Program', 'Penn World Tables']
            },
            {
                id: 'cba',
                term: 'Cost-Benefit Analysis',
                acronym: 'CBA',
                category: 'economics',
                definition: 'A systematic approach to estimating the strengths and weaknesses of alternatives by comparing the total expected costs against total expected benefits. In development, CBA monetizes social benefits and costs to determine whether interventions represent good value for money. Results are typically expressed as benefit-cost ratios or net present values.',
                formula: {
                    name: 'Benefit-Cost Ratio',
                    expression: 'BCR = ‚àë(B‚Çú / (1+r)·µó) / ‚àë(C‚Çú / (1+r)·µó)',
                    explanation: 'BCR compares discounted benefits to discounted costs. A BCR > 1 indicates that benefits exceed costs. The discount rate (r) reflects time preference and opportunity cost of capital.',
                    variables: [
                        { symbol: 'B‚Çú', meaning: 'Benefits in year t' },
                        { symbol: 'C‚Çú', meaning: 'Costs in year t' },
                        { symbol: 'r', meaning: 'Discount rate (typically 3-10% for social projects)' },
                        { symbol: 't', meaning: 'Time period' }
                    ]
                },
                caseStudy: null,
                relatedTerms: ['Cost-Effectiveness Analysis', 'Social Return on Investment', 'Net Present Value'],
                sources: ['ADB Cost-Benefit Guidelines', 'Copenhagen Consensus']
            },
            {
                id: 'cea',
                term: 'Cost-Effectiveness Analysis',
                acronym: 'CEA',
                category: 'economics',
                definition: 'A form of economic analysis comparing the relative costs and outcomes of different interventions to achieve a specific objective. Unlike CBA, CEA does not monetize outcomes, instead expressing results as cost per unit of outcome (e.g., cost per life saved, cost per DALY averted). This is particularly useful when monetizing benefits is ethically or practically challenging.',
                formula: {
                    name: 'Incremental Cost-Effectiveness Ratio',
                    expression: 'ICER = (C‚ÇÅ - C‚ÇÄ) / (E‚ÇÅ - E‚ÇÄ)',
                    explanation: 'ICER compares the additional cost of a new intervention relative to its additional effectiveness compared to a baseline or alternative intervention.',
                    variables: [
                        { symbol: 'C‚ÇÅ', meaning: 'Cost of new intervention' },
                        { symbol: 'C‚ÇÄ', meaning: 'Cost of comparator/baseline' },
                        { symbol: 'E‚ÇÅ', meaning: 'Effectiveness of new intervention' },
                        { symbol: 'E‚ÇÄ', meaning: 'Effectiveness of comparator/baseline' }
                    ]
                },
                caseStudy: null,
                relatedTerms: ['Cost-Benefit Analysis', 'DALY', 'QALY'],
                sources: ['WHO-CHOICE', 'Disease Control Priorities']
            },
            
            // Governance Terms
            {
                id: 'accountability',
                term: 'Accountability',
                acronym: null,
                category: 'governance',
                definition: 'The obligation of duty-bearers to take responsibility for their actions, be answerable for how they exercise their power, and accept consequences when commitments are not met. In development, accountability operates vertically (to funders/supervisors), horizontally (to peers/oversight bodies), and downward (to beneficiaries and communities).',
                formula: null,
                caseStudy: null,
                relatedTerms: ['Transparency', 'Governance', 'Social Accountability'],
                sources: ['World Bank Governance Indicators', 'UNDP Accountability Framework']
            },
            {
                id: 'social-accountability',
                term: 'Social Accountability',
                acronym: null,
                category: 'governance',
                definition: 'An approach to governance that builds accountability through civic engagement, where citizens and civil society organizations participate directly or indirectly in holding public officials accountable. Social accountability mechanisms include citizen report cards, community scorecards, participatory budgeting, and public expenditure tracking.',
                formula: null,
                caseStudy: {
                    title: 'Citizen Report Cards in Bangalore',
                    region: 'South Asia',
                    year: 1994,
                    summary: 'The Public Affairs Centre pioneered citizen report cards to rate public services in Bangalore. By publishing comparative performance data across agencies, the initiative created competitive pressure for improvement.',
                    keyFinding: 'Between 1994 and 2003, citizen satisfaction with municipal services improved from 9% to 34%, with the largest gains in agencies that actively engaged with feedback.'
                },
                relatedTerms: ['Accountability', 'Citizen Engagement', 'Transparency'],
                sources: ['World Bank Social Accountability Sourcebook', 'Paul (1998)']
            },
            {
                id: 'cdd',
                term: 'Community-Driven Development',
                acronym: 'CDD',
                category: 'governance',
                definition: 'An approach that gives control of development decisions and resources to community groups. CDD programmes operate on principles of participatory planning, community management of funds, and local implementation. Evidence on CDD effectiveness is mixed, with strong effects on infrastructure provision but weaker effects on social cohesion and governance.',
                formula: null,
                caseStudy: {
                    title: 'Indonesia\'s PNPM Programme',
                    region: 'South Asia',
                    year: 2007,
                    summary: 'PNPM Mandiri (National Programme for Community Empowerment) was one of the world\'s largest CDD programmes, providing block grants to over 70,000 villages for community-selected infrastructure and economic activities.',
                    keyFinding: 'Rigorous evaluation found PNPM increased access to health facilities by 5% and reduced poverty by 1.5 percentage points in participating villages, but had limited impact on governance quality.'
                },
                relatedTerms: ['Participatory Development', 'Local Governance', 'Decentralization'],
                sources: ['World Bank CDD Resources', 'Mansuri & Rao (2012)']
            },
            
            // Climate Terms
            {
                id: 'adaptation',
                term: 'Climate Adaptation',
                acronym: null,
                category: 'climate',
                definition: 'The process of adjustment to actual or expected climate and its effects, seeking to moderate harm or exploit beneficial opportunities. In human systems, adaptation may be anticipatory, reactive, incremental, or transformational. Successful adaptation reduces vulnerability and enhances adaptive capacity.',
                formula: null,
                caseStudy: {
                    title: 'Bangladesh Climate-Resilient Infrastructure',
                    region: 'South Asia',
                    year: 2018,
                    summary: 'Bangladesh\'s Delta Plan 2100 integrates climate adaptation into long-term infrastructure planning, including raised roads, flood-resistant housing, and salinity-resistant agriculture in coastal zones.',
                    keyFinding: 'Early investments in cyclone shelters and early warning systems have reduced cyclone mortality by 100-fold since 1970, demonstrating effective autonomous and planned adaptation.'
                },
                relatedTerms: ['Mitigation', 'Resilience', 'Vulnerability'],
                sources: ['IPCC AR6 WGII', 'UNFCCC Adaptation Resources']
            },
            {
                id: 'mitigation',
                term: 'Climate Mitigation',
                acronym: null,
                category: 'climate',
                definition: 'Human intervention to reduce the sources or enhance the sinks of greenhouse gases. Mitigation includes transitioning to renewable energy, improving energy efficiency, protecting and expanding forests, and changing land use practices. Mitigation efforts are measured in tonnes of CO‚ÇÇ equivalent reduced or avoided.',
                formula: null,
                caseStudy: null,
                relatedTerms: ['Adaptation', 'Carbon Pricing', 'NDCs'],
                sources: ['IPCC AR6 WGIII', 'UNEP Emissions Gap Report']
            },
            {
                id: 'ndc',
                term: 'Nationally Determined Contributions',
                acronym: 'NDC',
                category: 'climate',
                definition: 'Climate action plans submitted by countries under the Paris Agreement, outlining their intended emissions reductions and adaptation actions. NDCs are updated every five years with increasing ambition. They represent the primary mechanism for global climate governance but current collective ambition is insufficient to limit warming to 1.5¬∞C.',
                formula: null,
                caseStudy: null,
                relatedTerms: ['Paris Agreement', 'Mitigation', 'Climate Finance'],
                sources: ['UNFCCC NDC Registry', 'Climate Action Tracker']
            },
            
            // Additional Key Terms
            {
                id: 'baseline',
                term: 'Baseline',
                acronym: null,
                category: 'meal',
                definition: 'Data collected at the start of a project or programme that provides the basis for measuring subsequent change. A strong baseline describes the situation before the intervention begins, establishes values for all key indicators, and enables comparison with endline data to assess progress and impact.',
                formula: null,
                caseStudy: null,
                relatedTerms: ['Indicator', 'Endline', 'Monitoring'],
                sources: ['IFRC Baseline Guidelines', 'USAID M&E Resources']
            },
            {
                id: 'daly',
                term: 'Disability-Adjusted Life Year',
                acronym: 'DALY',
                category: 'economics',
                definition: 'A measure of overall disease burden, expressed as the number of years lost due to ill-health, disability, or early death. One DALY represents the loss of one year of full health. DALYs are used in global health priority-setting to compare the burden of different diseases and the cost-effectiveness of interventions.',
                formula: {
                    name: 'DALY Calculation',
                    expression: 'DALY = YLL + YLD',
                    explanation: 'DALYs sum years of life lost to premature mortality and years lived with disability, weighted by severity.',
                    variables: [
                        { symbol: 'YLL', meaning: 'Years of Life Lost (mortality component)' },
                        { symbol: 'YLD', meaning: 'Years Lived with Disability (morbidity component)' }
                    ]
                },
                caseStudy: null,
                relatedTerms: ['QALY', 'Cost-Effectiveness', 'Disease Burden'],
                sources: ['WHO Global Burden of Disease', 'IHME GBD Study']
            },
            {
                id: 'psm',
                term: 'Propensity Score Matching',
                acronym: 'PSM',
                category: 'research',
                definition: 'A statistical matching technique that estimates the effect of a treatment by accounting for covariates that predict receiving the treatment. PSM creates a comparison group from non-participants who are similar to participants on observable characteristics, reducing selection bias in quasi-experimental designs.',
                formula: {
                    name: 'Propensity Score',
                    expression: 'p(X) = Pr(D = 1 | X)',
                    explanation: 'The propensity score is the probability of receiving treatment given observed covariates. Matching on p(X) balances observable characteristics between groups.',
                    variables: [
                        { symbol: 'D', meaning: 'Treatment indicator (1 = treated, 0 = untreated)' },
                        { symbol: 'X', meaning: 'Vector of observed pre-treatment covariates' },
                        { symbol: 'p(X)', meaning: 'Propensity score' }
                    ]
                },
                caseStudy: null,
                relatedTerms: ['Counterfactual', 'Selection Bias', 'Matching'],
                sources: ['Rosenbaum & Rubin (1983)', 'Caliendo & Kopeinig (2008)']
            },
            {
                id: 'sroi',
                term: 'Social Return on Investment',
                acronym: 'SROI',
                category: 'economics',
                definition: 'A framework for measuring and accounting for a broad concept of value that incorporates social, environmental, and economic costs and benefits. SROI assigns monetary values to outcomes that are not conventionally valued in market terms, producing a ratio of benefits to investment (e.g., ¬£5 of social value per ¬£1 invested).',
                formula: {
                    name: 'SROI Ratio',
                    expression: 'SROI = Net Present Value of Benefits / Investment',
                    explanation: 'The SROI ratio indicates social value created per unit of investment. Values greater than 1 indicate positive social return.',
                    variables: [
                        { symbol: 'NPV Benefits', meaning: 'Discounted sum of monetized social outcomes' },
                        { symbol: 'Investment', meaning: 'Total investment in the intervention' }
                    ]
                },
                caseStudy: null,
                relatedTerms: ['Cost-Benefit Analysis', 'Impact Measurement', 'Value for Money'],
                sources: ['Social Value International', 'SROI Guide (2012)']
            },
            {
                id: 'vulnerability',
                term: 'Vulnerability',
                acronym: null,
                category: 'climate',
                definition: 'The propensity or predisposition to be adversely affected. In climate contexts, vulnerability encompasses sensitivity to climate impacts, exposure to climate hazards, and the lack of capacity to cope and adapt. Vulnerability is context-specific and differs among individuals, households, and communities based on multiple interacting factors.',
                formula: {
                    name: 'Vulnerability Framework',
                    expression: 'V = f(E, S, AC)',
                    explanation: 'Vulnerability is a function of exposure to hazards, sensitivity to those hazards, and adaptive capacity to cope with and recover from impacts.',
                    variables: [
                        { symbol: 'E', meaning: 'Exposure to climate hazards' },
                        { symbol: 'S', meaning: 'Sensitivity to climate impacts' },
                        { symbol: 'AC', meaning: 'Adaptive capacity' }
                    ]
                },
                caseStudy: null,
                relatedTerms: ['Resilience', 'Adaptation', 'Risk'],
                sources: ['IPCC AR6', 'Adger (2006)']
            },
            {
                id: 'externality',
                term: 'Externality',
                acronym: null,
                category: 'economics',
                definition: 'A cost or benefit that affects a party who did not choose to incur that cost or benefit. Negative externalities (like pollution) impose costs on third parties, while positive externalities (like education) provide benefits beyond the individual. Externalities represent market failures that justify government intervention.',
                formula: null,
                caseStudy: null,
                relatedTerms: ['Market Failure', 'Public Good', 'Social Cost'],
                sources: ['Pigou (1920)', 'Coase (1960)']
            },
            {
                id: 'capabilities',
                term: 'Capability Approach',
                acronym: null,
                category: 'economics',
                definition: 'A theoretical framework developed by Amartya Sen and Martha Nussbaum that evaluates well-being and development in terms of the substantive freedoms (capabilities) that people have to achieve lives they have reason to value. The approach focuses on what people are able to do and be, rather than on resources or utility.',
                formula: null,
                caseStudy: null,
                relatedTerms: ['HDI', 'Well-being', 'Freedom'],
                sources: ['Sen (1999) Development as Freedom', 'Nussbaum (2011)']
            },
            {
                id: 'spillover',
                term: 'Spillover Effects',
                acronym: null,
                category: 'research',
                definition: 'Effects of an intervention that extend beyond the direct participants to non-participants. Spillovers can be positive (when untreated neighbors benefit from treatment) or negative (when treatment diverts resources from non-participants). Ignoring spillovers can bias impact estimates and misrepresent true programme effects.',
                formula: null,
                caseStudy: {
                    title: 'Kenya Deworming Spillovers',
                    region: 'Africa',
                    year: 2004,
                    summary: 'Miguel and Kremer\'s study of school-based deworming in Kenya found large positive spillovers: untreated children in treatment schools had lower infection rates due to reduced transmission.',
                    keyFinding: 'Including spillover effects increased the estimated cost-effectiveness by over 60%, fundamentally changing the policy calculus for deworming programmes.'
                },
                relatedTerms: ['Externality', 'General Equilibrium', 'RCT'],
                sources: ['Miguel & Kremer (2004)', 'Angelucci & Di Maro (2016)']
            }
        ];
        
        // ============================================================
        // CASE STUDIES DATA
        // ============================================================
        const CASE_STUDIES_DATA = [
            {
                id: 'case-progresa',
                title: 'Progresa/Oportunidades: The CCT Revolution',
                region: 'latin-america',
                country: 'Mexico',
                year: 1997,
                categories: ['Poverty', 'Education', 'Health', 'RCT'],
                icon: 'üá≤üáΩ',
                summary: 'How Mexico\'s conditional cash transfer programme transformed global social protection policy through rigorous randomized evaluation.',
                content: `Progresa (later Oportunidades, now Prospera) began in 1997 as Mexico's flagship anti-poverty programme, providing cash transfers to poor rural families conditional on children's school attendance and regular health check-ups.

**The Innovation**: Unlike previous poverty programmes, Progresa was designed from the start with rigorous impact evaluation built in. The randomized rollout across 506 communities created one of the most influential RCTs in development economics.

**Key Findings**:
- School enrollment increased 3.4% for girls in secondary grades
- Illness episodes fell by 12% among children 0-5
- Per capita consumption increased 10% among beneficiary households
- Intergenerational effects showed children of beneficiaries had better educational outcomes

**Policy Impact**: The evidence from Progresa catalyzed the global expansion of CCT programmes to over 60 countries, from Brazil's Bolsa Fam√≠lia to India's Janani Suraksha Yojana.`,
                keyLessons: [
                    'Built-in randomization enables rigorous causal inference',
                    'Conditionality may be less important than cash transfer itself',
                    'Long-term follow-up reveals sustained human capital effects'
                ],
                sources: ['Schultz (2004)', 'Parker & Todd (2017)']
            },
            {
                id: 'case-graduation',
                title: 'The Graduation Approach: Ultra-Poor Pathways',
                region: 'global',
                country: 'Multiple',
                year: 2002,
                categories: ['Poverty', 'Livelihoods', 'RCT'],
                icon: 'üåç',
                summary: 'BRAC\'s holistic approach to helping the ultra-poor "graduate" from extreme poverty through asset transfers, training, and ongoing support.',
                content: `BRAC's Targeting the Ultra-Poor (TUP) programme, launched in Bangladesh in 2002, pioneered the "graduation approach" - a comprehensive package designed to help the poorest households build sustainable livelihoods.

**The Model**: The approach combines:
1. Asset transfer (typically livestock)
2. Skills training and coaching
3. Consumption support during the transition
4. Access to savings and healthcare
5. Social integration support

**The Evidence**: A landmark 6-country RCT (Bangladesh, Ethiopia, Ghana, Honduras, India, Pakistan) published in Science (2015) tested the approach across diverse contexts.

**Results at 3-year follow-up**:
- Consumption: +11% average increase
- Assets: +15% average increase
- Food security: +7 percentage points improvement
- Mental health: Significant improvements in well-being measures

**Sustainability**: Effects persisted and grew after programme support ended, indicating true graduation from poverty rather than temporary relief.`,
                keyLessons: [
                    'Multi-component interventions can address poverty traps',
                    'Effects replicate across diverse cultural and economic contexts',
                    'Sustained coaching matters as much as asset transfer'
                ],
                sources: ['Banerjee et al. (2015) Science', 'J-PAL Graduation Approach Evidence']
            },
            {
                id: 'case-deworm',
                title: 'Deworming Debates: Evidence Interpretation',
                region: 'africa',
                country: 'Kenya',
                year: 1998,
                categories: ['Health', 'Education', 'RCT', 'Spillovers'],
                icon: 'üá∞üá™',
                summary: 'The ongoing scientific debate over school-based deworming illustrates challenges in evidence interpretation and policy translation.',
                content: `The Kenya deworming study by Miguel and Kremer (2004) has become one of the most cited and contested evaluations in development economics, illustrating both the power and limitations of RCT evidence.

**The Original Study**: School-based deworming in Western Kenya showed dramatic effects: reduced absenteeism by 25%, significant spillovers to untreated students, and long-term earnings gains of 20% in follow-up studies.

**The Controversy**: A 2015 replication by Cochrane found much smaller effects when pooling clinical trials. This sparked intense debate about:
- RCT vs. epidemiological evidence
- Population vs. individual-level effects
- Spillover measurement challenges
- Cost-effectiveness thresholds

**Current Consensus**: While initial effect sizes may have been overstated, mass deworming remains highly cost-effective given:
- Very low cost ($0.50/child/year)
- Minimal risk
- Long-term earnings gains in settings with high worm burden

**Policy Implications**: Over 600 million children now receive deworming treatment annually, demonstrating how contested evidence still informs major policy decisions.`,
                keyLessons: [
                    'Effect sizes may vary by context and disease burden',
                    'Spillover effects require careful measurement design',
                    'Cost-effectiveness depends on local epidemiology'
                ],
                sources: ['Miguel & Kremer (2004)', 'Baird et al. (2016)', 'Cochrane Review (2019)']
            },
            {
                id: 'case-sewa',
                title: 'SEWA: Organizing the Informal Economy',
                region: 'south-asia',
                country: 'India',
                year: 1972,
                categories: ['Gender', 'Labour', 'Microfinance', 'Organizing'],
                icon: 'üáÆüá≥',
                summary: 'How the Self-Employed Women\'s Association built power and services for 2 million informal sector women workers across India.',
                content: `The Self-Employed Women's Association (SEWA), founded in 1972 by Ela Bhatt, is the world's largest organization of informal sector workers, with over 2 million members.

**The Model**: SEWA combines:
- **Union**: Collective bargaining and policy advocacy
- **Cooperative**: Financial services (SEWA Bank), insurance, childcare
- **Movement**: Building women's leadership and voice

**Intersectional Approach**: SEWA explicitly addresses overlapping vulnerabilities - members are typically poor, female, self-employed, and often from marginalized castes. The organization treats economic empowerment and social change as inseparable.

**Impact Evidence**:
- SEWA Bank has issued over $350 million in loans with 96% repayment
- Members report 25% higher incomes than non-members
- Significant improvements in women's decision-making power
- Policy wins including minimum wages for home-based workers

**Replication**: The SEWA model has inspired organizing efforts globally, from StreetNet International to HomeNet networks across Asia.`,
                keyLessons: [
                    'Organizing and services are complementary strategies',
                    'Intersectionality requires multi-dimensional programming',
                    'Women\'s voice and agency matter as much as income'
                ],
                sources: ['Chen (2012)', 'SEWA Annual Reports', 'WIEGO Resources']
            },
            {
                id: 'case-braced',
                title: 'BRACED: Adaptive Climate Resilience',
                region: 'africa',
                country: 'Multiple (Sahel)',
                year: 2015,
                categories: ['Climate', 'Resilience', 'ToC', 'Adaptive Management'],
                icon: 'üåç',
                summary: 'How DFID\'s ¬£140 million climate resilience programme used Theory of Change for adaptive management across diverse contexts.',
                content: `Building Resilience and Adaptation to Climate Extremes and Disasters (BRACED) was DFID's flagship climate resilience programme, implemented across 15 projects in 13 countries from 2015-2019.

**ToC as Core Methodology**: Each project developed context-specific Theories of Change that were:
- Co-created with local stakeholders
- Regularly tested against emerging evidence
- Adapted when assumptions proved wrong

**The 3As Framework**: BRACED operationalized resilience through:
1. **Anticipatory capacity**: Early warning, forecasting
2. **Absorptive capacity**: Coping with shocks
3. **Adaptive capacity**: Long-term adjustment

**Key Learning**:
- 73% of projects modified strategies based on ToC evidence
- Gender-transformative approaches enhanced resilience outcomes
- Local governance strengthening was critical across contexts
- Shock-responsive safety nets proved highly effective

**Evidence Gap**: The programme revealed persistent challenges in measuring "resilience" as an outcome, leading to methodological innovations in resilience measurement.`,
                keyLessons: [
                    'Theory of Change enables structured adaptive management',
                    'Resilience requires action at multiple scales simultaneously',
                    'Gender analysis is essential for effective climate programming'
                ],
                sources: ['BRACED Knowledge Manager Reports', 'B√©n√© et al. (2017)']
            }
        ];
        
        // ============================================================
        // FORMULAE DATA
        // ============================================================
        const FORMULAE_DATA = [
            {
                id: 'formula-ate',
                name: 'Average Treatment Effect',
                category: 'Impact Evaluation',
                formula: 'ATE = E[Y‚ÇÅ - Y‚ÇÄ]',
                description: 'Measures the average causal effect of treatment across the population.',
                fullExplanation: 'The Average Treatment Effect represents the difference in expected outcomes between treatment and control conditions across the entire population. It answers: "What is the average impact of this intervention?"'
            },
            {
                id: 'formula-did',
                name: 'Difference-in-Differences',
                category: 'Impact Evaluation',
                formula: '(»≤_T,post - »≤_T,pre) - (»≤_C,post - »≤_C,pre)',
                description: 'Compares changes over time between treatment and control groups.',
                fullExplanation: 'DiD removes both pre-existing group differences and common time trends, isolating the treatment effect under the parallel trends assumption.'
            },
            {
                id: 'formula-gini',
                name: 'Gini Coefficient',
                category: 'Inequality',
                formula: 'G = A / (A + B)',
                description: 'Measures income/wealth inequality from 0 (perfect equality) to 1 (perfect inequality).',
                fullExplanation: 'Derived from the Lorenz curve, where A is the area between the equality line and the Lorenz curve, and B is the area under the Lorenz curve.'
            },
            {
                id: 'formula-hdi',
                name: 'Human Development Index',
                category: 'Development',
                formula: 'HDI = (I_health √ó I_education √ó I_income)^(1/3)',
                description: 'Composite measure of health, education, and living standards.',
                fullExplanation: 'The geometric mean ensures that low achievement in one dimension cannot be fully compensated by high achievement in another.'
            },
            {
                id: 'formula-mpi',
                name: 'Multidimensional Poverty Index',
                category: 'Poverty',
                formula: 'MPI = H √ó A',
                description: 'Captures both incidence (H) and intensity (A) of multidimensional poverty.',
                fullExplanation: 'H = proportion of population who are MPI poor; A = average proportion of deprivations among the poor.'
            },
            {
                id: 'formula-bcr',
                name: 'Benefit-Cost Ratio',
                category: 'Economic Analysis',
                formula: 'BCR = Œ£(B‚Çú/(1+r)·µó) / Œ£(C‚Çú/(1+r)·µó)',
                description: 'Compares discounted benefits to discounted costs. BCR > 1 indicates positive returns.',
                fullExplanation: 'Time-discounting reflects the opportunity cost of capital and society\'s time preference. Social discount rates typically range from 3-10%.'
            },
            {
                id: 'formula-icer',
                name: 'Incremental Cost-Effectiveness Ratio',
                category: 'Health Economics',
                formula: 'ICER = (C‚ÇÅ - C‚ÇÄ) / (E‚ÇÅ - E‚ÇÄ)',
                description: 'Additional cost per additional unit of health outcome (e.g., cost per DALY averted).',
                fullExplanation: 'ICER helps decision-makers compare interventions on a standardized basis when monetary valuation of outcomes is difficult.'
            },
            {
                id: 'formula-daly',
                name: 'Disability-Adjusted Life Year',
                category: 'Health',
                formula: 'DALY = YLL + YLD',
                description: 'Years of healthy life lost to mortality (YLL) and morbidity (YLD).',
                fullExplanation: 'One DALY = one lost year of healthy life. DALYs enable comparison of disease burden across conditions and populations.'
            },
            {
                id: 'formula-power',
                name: 'Statistical Power',
                category: 'Research Methods',
                formula: 'N = 2(ZŒ± + ZŒ≤)¬≤œÉ¬≤ / Œ¥¬≤',
                description: 'Sample size required to detect a given effect size with specified power.',
                fullExplanation: 'Where ZŒ± = critical value for significance level, ZŒ≤ = critical value for power, œÉ¬≤ = variance, Œ¥ = minimum detectable effect.'
            },
            {
                id: 'formula-sroi',
                name: 'Social Return on Investment',
                category: 'Impact Measurement',
                formula: 'SROI = NPV(Benefits) / Investment',
                description: 'Social value created per unit of investment (e.g., ¬£5 value per ¬£1 invested).',
                fullExplanation: 'SROI monetizes social outcomes to compare interventions on a standardized value basis.'
            }
        ];
        
        // ============================================================
        // APP STATE
        // ============================================================
        let currentView = 'glossary';
        let currentCategory = 'all';
        let currentTerm = null;
        let bookmarks = JSON.parse(localStorage.getItem('impactlex-bookmarks') || '[]');
        let darkMode = localStorage.getItem('impactlex-theme') === 'dark';
        
        // ============================================================
        // INITIALIZATION
        // ============================================================
        document.addEventListener('DOMContentLoaded', () => {
            initTheme();
            initSearch();
            initCategoryChips();
            renderGlossary();
            renderFormulae();
            renderCaseStudies();
            updateStats();
            updateBookmarkBadge();
            showTermOfDay();
            initPWA();
            renderMath();
        });
        
        // ============================================================
        // THEME
        // ============================================================
        function initTheme() {
            if (darkMode) {
                document.documentElement.setAttribute('data-theme', 'dark');
                updateThemeIcons();
            }
        }
        
        function toggleTheme() {
            darkMode = !darkMode;
            if (darkMode) {
                document.documentElement.setAttribute('data-theme', 'dark');
            } else {
                document.documentElement.removeAttribute('data-theme');
            }
            localStorage.setItem('impactlex-theme', darkMode ? 'dark' : 'light');
            updateThemeIcons();
        }
        
        function updateThemeIcons() {
            const lightIcon = document.querySelector('.theme-icon-light');
            const darkIcon = document.querySelector('.theme-icon-dark');
            if (darkMode) {
                lightIcon.style.display = 'none';
                darkIcon.style.display = 'block';
            } else {
                lightIcon.style.display = 'block';
                darkIcon.style.display = 'none';
            }
        }
        
        // ============================================================
        // NAVIGATION
        // ============================================================
        function navigateTo(view) {
            currentView = view;
            
            // Update nav buttons
            document.querySelectorAll('.nav-item').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.view === view);
            });
            
            // Show correct view
            document.querySelectorAll('.view').forEach(v => {
                v.classList.toggle('active', v.id === `${view}-view`);
            });
            
            // Render bookmarks if needed
            if (view === 'bookmarks') {
                renderBookmarks();
            }
        }
        
        // ============================================================
        // SEARCH
        // ============================================================
        function initSearch() {
            const searchInput = document.getElementById('searchInput');
            const searchClear = document.getElementById('searchClear');
            
            searchInput.addEventListener('input', (e) => {
                const query = e.target.value.trim();
                searchClear.classList.toggle('visible', query.length > 0);
                filterGlossary(query);
            });
            
            searchClear.addEventListener('click', () => {
                searchInput.value = '';
                searchClear.classList.remove('visible');
                filterGlossary('');
                searchInput.focus();
            });
            
            // Formula search
            const formulaSearch = document.getElementById('formulaSearchInput');
            if (formulaSearch) {
                formulaSearch.addEventListener('input', (e) => {
                    filterFormulae(e.target.value.trim());
                });
            }
            
            // Case search
            const caseSearch = document.getElementById('caseSearchInput');
            if (caseSearch) {
                caseSearch.addEventListener('input', (e) => {
                    filterCases(e.target.value.trim());
                });
            }
        }
        
        function filterGlossary(query) {
            const q = query.toLowerCase();
            const filteredTerms = GLOSSARY_DATA.filter(term => {
                const matchesSearch = !q || 
                    term.term.toLowerCase().includes(q) ||
                    (term.acronym && term.acronym.toLowerCase().includes(q)) ||
                    term.definition.toLowerCase().includes(q);
                const matchesCategory = currentCategory === 'all' || term.category === currentCategory;
                return matchesSearch && matchesCategory;
            });
            renderGlossaryList(filteredTerms);
        }
        
        function filterFormulae(query) {
            const q = query.toLowerCase();
            const filtered = FORMULAE_DATA.filter(f => 
                !q || f.name.toLowerCase().includes(q) || f.category.toLowerCase().includes(q)
            );
            renderFormulaeList(filtered);
        }
        
        function filterCases(query) {
            const q = query.toLowerCase();
            const filtered = CASE_STUDIES_DATA.filter(c =>
                !q || c.title.toLowerCase().includes(q) || c.summary.toLowerCase().includes(q)
            );
            renderCasesList(filtered);
        }
        
        // ============================================================
        // CATEGORY CHIPS
        // ============================================================
        function initCategoryChips() {
            const chips = document.getElementById('categoryChips');
            chips.addEventListener('click', (e) => {
                const chip = e.target.closest('.chip');
                if (!chip) return;
                
                document.querySelectorAll('#categoryChips .chip').forEach(c => c.classList.remove('active'));
                chip.classList.add('active');
                currentCategory = chip.dataset.category;
                
                const searchQuery = document.getElementById('searchInput').value.trim();
                filterGlossary(searchQuery);
            });
            
            // Case chips
            const caseChips = document.getElementById('caseChips');
            if (caseChips) {
                caseChips.addEventListener('click', (e) => {
                    const chip = e.target.closest('.chip');
                    if (!chip) return;
                    
                    document.querySelectorAll('#caseChips .chip').forEach(c => c.classList.remove('active'));
                    chip.classList.add('active');
                    
                    const region = chip.dataset.category;
                    const filtered = region === 'all' 
                        ? CASE_STUDIES_DATA 
                        : CASE_STUDIES_DATA.filter(c => c.region === region);
                    renderCasesList(filtered);
                });
            }
        }
        
        // ============================================================
        // RENDER GLOSSARY
        // ============================================================
        function renderGlossary() {
            renderGlossaryList(GLOSSARY_DATA);
        }
        
        function renderGlossaryList(terms) {
            const container = document.getElementById('glossaryList');
            
            if (terms.length === 0) {
                container.innerHTML = `
                    <div class="bookmarks-empty">
                        <div class="bookmarks-empty-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/>
                            </svg>
                        </div>
                        <div class="bookmarks-empty-title">No terms found</div>
                        <div class="bookmarks-empty-text">Try adjusting your search or filters</div>
                    </div>
                `;
                return;
            }
            
            // Group by first letter
            const grouped = {};
            terms.forEach(term => {
                const letter = term.term[0].toUpperCase();
                if (!grouped[letter]) grouped[letter] = [];
                grouped[letter].push(term);
            });
            
            const sortedLetters = Object.keys(grouped).sort();
            
            container.innerHTML = sortedLetters.map(letter => `
                <div class="glossary-section">
                    <div class="glossary-letter">
                        <div class="glossary-letter-char">${letter}</div>
                        <div class="glossary-letter-line"></div>
                    </div>
                    ${grouped[letter].map(term => renderTermCard(term)).join('')}
                </div>
            `).join('');
        }
        
        function renderTermCard(term) {
            const categoryLabels = {
                'meal': 'MEAL',
                'toc': 'Theory of Change',
                'gender': 'Gender',
                'research': 'Research Methods',
                'economics': 'Dev Economics',
                'governance': 'Governance',
                'climate': 'Climate'
            };
            
            return `
                <div class="term-card" onclick="openTermModal('${term.id}')">
                    <div class="term-header">
                        <div>
                            <div class="term-title">${term.term}</div>
                            ${term.acronym ? `<span class="term-acronym">${term.acronym}</span>` : ''}
                        </div>
                        <div class="term-badges">
                            <span class="term-badge badge-category">${categoryLabels[term.category] || term.category}</span>
                            ${term.formula ? '<span class="term-badge badge-formula">Formula</span>' : ''}
                            ${term.caseStudy ? '<span class="term-badge badge-case">Case Study</span>' : ''}
                        </div>
                    </div>
                    <div class="term-preview">${term.definition}</div>
                    <div class="term-meta">
                        <span class="term-meta-item">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
                            </svg>
                            ${term.relatedTerms.length} related
                        </span>
                        <span class="term-meta-item">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                            </svg>
                            ${term.sources.length} sources
                        </span>
                    </div>
                </div>
            `;
        }
        
        // ============================================================
        // RENDER FORMULAE
        // ============================================================
        function renderFormulae() {
            renderFormulaeList(FORMULAE_DATA);
        }
        
        function renderFormulaeList(formulae) {
            const container = document.getElementById('formulaGrid');
            container.innerHTML = formulae.map(f => `
                <div class="formula-card" onclick="openFormulaModal('${f.id}')">
                    <div class="formula-card-header">
                        <div class="formula-card-category">${f.category}</div>
                        <div class="formula-card-title">${f.name}</div>
                    </div>
                    <div class="formula-card-body">
                        <div class="formula-card-formula">${f.formula}</div>
                        <div class="formula-card-desc">${f.description}</div>
                    </div>
                </div>
            `).join('');
        }
        
        // ============================================================
        // RENDER CASE STUDIES
        // ============================================================
        function renderCaseStudies() {
            renderCasesList(CASE_STUDIES_DATA);
        }
        
        function renderCasesList(cases) {
            const container = document.getElementById('caseStudiesList');
            container.innerHTML = cases.map(c => `
                <div class="case-card" onclick="openCaseModal('${c.id}')">
                    <div class="case-card-image">${c.icon}</div>
                    <div class="case-card-content">
                        <div class="case-card-tags">
                            ${c.categories.slice(0, 3).map(cat => `<span class="case-card-tag">${cat}</span>`).join('')}
                        </div>
                        <div class="case-card-title">${c.title}</div>
                        <div class="case-card-meta">
                            <span>${c.country}</span>
                            <span>‚Ä¢</span>
                            <span>${c.year}</span>
                        </div>
                        <div class="case-card-excerpt">${c.summary}</div>
                    </div>
                </div>
            `).join('');
        }
        
        // ============================================================
        // MODALS
        // ============================================================
        function openTermModal(termId) {
            const term = GLOSSARY_DATA.find(t => t.id === termId);
            if (!term) return;
            
            currentTerm = term;
            
            document.getElementById('modalTitle').textContent = term.term;
            const acronymEl = document.getElementById('modalAcronym');
            if (term.acronym) {
                acronymEl.textContent = term.acronym;
                acronymEl.style.display = 'inline-block';
            } else {
                acronymEl.style.display = 'none';
            }
            
            let bodyHTML = `
                <div class="modal-section">
                    <div class="modal-section-title">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
                        </svg>
                        Definition
                    </div>
                    <div class="modal-definition">${term.definition}</div>
                </div>
            `;
            
            // Formula section
            if (term.formula) {
                bodyHTML += `
                    <div class="modal-section">
                        <div class="modal-section-title">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M4 4h6v6H4zM14 4h6v6h-6zM4 14h6v6H4z"/><path d="M17 14v8M14 17h6"/>
                            </svg>
                            Formula
                        </div>
                        <div class="formula-box">
                            <div class="formula-title">${term.formula.name}</div>
                            <div class="formula-content">${term.formula.expression}</div>
                            <div class="formula-explanation">
                                <p>${term.formula.explanation}</p>
                                ${term.formula.variables ? `
                                    <div style="margin-top: 0.75rem;">
                                        <strong>Variables:</strong><br>
                                        ${term.formula.variables.map(v => `
                                            <div class="formula-var">
                                                <code>${v.symbol}</code> = ${v.meaning}
                                            </div>
                                        `).join('')}
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                `;
            }
            
            // Case study section
            if (term.caseStudy) {
                bodyHTML += `
                    <div class="modal-section">
                        <div class="modal-section-title">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="2" y="7" width="20" height="14" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/>
                            </svg>
                            Case Study
                        </div>
                        <div class="case-study-box">
                            <div class="case-study-header">
                                <div class="case-study-label">Real-World Application</div>
                                <div class="case-study-title">${term.caseStudy.title}</div>
                                <div class="case-study-meta">
                                    <span>${term.caseStudy.region}</span>
                                    <span>‚Ä¢</span>
                                    <span>${term.caseStudy.year}</span>
                                </div>
                            </div>
                            <div class="case-study-body">
                                <div class="case-study-text">${term.caseStudy.summary}</div>
                                <div class="case-study-highlight">
                                    <div class="case-study-highlight-title">Key Finding</div>
                                    <div class="case-study-text">${term.caseStudy.keyFinding}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            // Related terms
            bodyHTML += `
                <div class="modal-section">
                    <div class="modal-section-title">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/>
                        </svg>
                        Related Terms
                    </div>
                    <div class="related-terms">
                        ${term.relatedTerms.map(rt => `
                            <span class="related-term" onclick="searchRelatedTerm('${rt}')">${rt}</span>
                        `).join('')}
                    </div>
                </div>
            `;
            
            // Sources
            bodyHTML += `
                <div class="modal-section">
                    <div class="modal-section-title">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                        </svg>
                        Sources
                    </div>
                    <ul class="sources-list">
                        ${term.sources.map(s => `<li class="source-item">${s}</li>`).join('')}
                    </ul>
                </div>
            `;
            
            document.getElementById('modalBody').innerHTML = bodyHTML;
            updateBookmarkButton();
            document.getElementById('termModal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        function openFormulaModal(formulaId) {
            const formula = FORMULAE_DATA.find(f => f.id === formulaId);
            if (!formula) return;
            
            // Find related glossary term
            const relatedTerm = GLOSSARY_DATA.find(t => t.formula && t.formula.name === formula.name);
            if (relatedTerm) {
                openTermModal(relatedTerm.id);
            } else {
                // Show simple formula modal
                currentTerm = { id: formulaId, term: formula.name };
                document.getElementById('modalTitle').textContent = formula.name;
                document.getElementById('modalAcronym').style.display = 'none';
                
                document.getElementById('modalBody').innerHTML = `
                    <div class="modal-section">
                        <div class="modal-section-title">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M4 4h6v6H4zM14 4h6v6h-6zM4 14h6v6H4z"/><path d="M17 14v8M14 17h6"/>
                            </svg>
                            Formula
                        </div>
                        <div class="formula-box">
                            <div class="formula-title">${formula.category}</div>
                            <div class="formula-content">${formula.formula}</div>
                            <div class="formula-explanation">${formula.fullExplanation}</div>
                        </div>
                    </div>
                `;
                
                updateBookmarkButton();
                document.getElementById('termModal').classList.add('active');
                document.body.style.overflow = 'hidden';
            }
        }
        
        function openCaseModal(caseId) {
            const caseStudy = CASE_STUDIES_DATA.find(c => c.id === caseId);
            if (!caseStudy) return;
            
            currentTerm = { id: caseId, term: caseStudy.title };
            document.getElementById('modalTitle').textContent = caseStudy.title;
            document.getElementById('modalAcronym').style.display = 'none';
            
            document.getElementById('modalBody').innerHTML = `
                <div class="modal-section">
                    <div class="case-study-meta" style="margin-bottom: 1rem;">
                        <span>${caseStudy.icon} ${caseStudy.country}</span>
                        <span>‚Ä¢</span>
                        <span>${caseStudy.year}</span>
                    </div>
                    <div class="term-badges" style="margin-bottom: 1rem;">
                        ${caseStudy.categories.map(cat => `<span class="term-badge badge-case">${cat}</span>`).join('')}
                    </div>
                    <div class="modal-definition" style="white-space: pre-line;">${caseStudy.content}</div>
                </div>
                
                <div class="modal-section">
                    <div class="modal-section-title">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                            <polyline points="22 4 12 14.01 9 11.01"/>
                        </svg>
                        Key Lessons
                    </div>
                    <ul class="sources-list">
                        ${caseStudy.keyLessons.map(l => `<li class="source-item">${l}</li>`).join('')}
                    </ul>
                </div>
                
                <div class="modal-section">
                    <div class="modal-section-title">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                        </svg>
                        Sources
                    </div>
                    <ul class="sources-list">
                        ${caseStudy.sources.map(s => `<li class="source-item">${s}</li>`).join('')}
                    </ul>
                </div>
            `;
            
            updateBookmarkButton();
            document.getElementById('termModal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        function closeModal() {
            document.getElementById('termModal').classList.remove('active');
            document.body.style.overflow = '';
            currentTerm = null;
        }
        
        function searchRelatedTerm(termName) {
            closeModal();
            const term = GLOSSARY_DATA.find(t => t.term === termName || t.relatedTerms.includes(termName));
            if (term) {
                setTimeout(() => openTermModal(term.id), 300);
            } else {
                document.getElementById('searchInput').value = termName;
                filterGlossary(termName);
                navigateTo('glossary');
            }
        }
        
        // Close modal on overlay click
        document.getElementById('termModal').addEventListener('click', (e) => {
            if (e.target.id === 'termModal') {
                closeModal();
            }
        });
        
        // ============================================================
        // BOOKMARKS
        // ============================================================
        function toggleBookmark() {
            if (!currentTerm) return;
            
            const index = bookmarks.findIndex(b => b.id === currentTerm.id);
            if (index === -1) {
                bookmarks.push({
                    id: currentTerm.id,
                    term: currentTerm.term,
                    savedAt: new Date().toISOString()
                });
                showToast('Saved to bookmarks');
            } else {
                bookmarks.splice(index, 1);
                showToast('Removed from bookmarks');
            }
            
            localStorage.setItem('impactlex-bookmarks', JSON.stringify(bookmarks));
            updateBookmarkButton();
            updateBookmarkBadge();
        }
        
        function updateBookmarkButton() {
            if (!currentTerm) return;
            
            const btn = document.getElementById('bookmarkBtn');
            const text = document.getElementById('bookmarkBtnText');
            const isBookmarked = bookmarks.some(b => b.id === currentTerm.id);
            
            if (isBookmarked) {
                btn.classList.add('bookmarked');
                text.textContent = 'Saved';
            } else {
                btn.classList.remove('bookmarked');
                text.textContent = 'Save';
            }
        }
        
        function updateBookmarkBadge() {
            const badge = document.getElementById('bookmarkBadge');
            if (bookmarks.length > 0) {
                badge.textContent = bookmarks.length;
                badge.style.display = 'flex';
            } else {
                badge.style.display = 'none';
            }
        }
        
        function renderBookmarks() {
            const container = document.getElementById('bookmarksList');
            
            if (bookmarks.length === 0) {
                container.innerHTML = `
                    <div class="bookmarks-empty">
                        <div class="bookmarks-empty-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"/>
                            </svg>
                        </div>
                        <div class="bookmarks-empty-title">No saved terms yet</div>
                        <div class="bookmarks-empty-text">Tap the save button on any term to add it here</div>
                    </div>
                `;
                return;
            }
            
            const bookmarkedTerms = bookmarks.map(b => {
                const term = GLOSSARY_DATA.find(t => t.id === b.id);
                const formula = FORMULAE_DATA.find(f => f.id === b.id);
                const caseStudy = CASE_STUDIES_DATA.find(c => c.id === b.id);
                return term || formula || caseStudy || { id: b.id, term: b.term, definition: 'Term data unavailable' };
            }).filter(Boolean);
            
            container.innerHTML = bookmarkedTerms.map(term => {
                if (term.formula !== undefined) {
                    return renderTermCard(term);
                } else if (term.categories) {
                    return `
                        <div class="term-card" onclick="openCaseModal('${term.id}')">
                            <div class="term-header">
                                <div class="term-title">${term.title || term.term}</div>
                            </div>
                            <div class="term-preview">${term.summary || 'Case study'}</div>
                        </div>
                    `;
                } else {
                    return `
                        <div class="term-card" onclick="openFormulaModal('${term.id}')">
                            <div class="term-header">
                                <div class="term-title">${term.name || term.term}</div>
                            </div>
                            <div class="term-preview">${term.description || 'Formula'}</div>
                        </div>
                    `;
                }
            }).join('');
        }
        
        function exportBookmarks() {
            if (bookmarks.length === 0) {
                showToast('No bookmarks to export');
                return;
            }
            
            const headers = ['Term', 'Saved Date'];
            const rows = bookmarks.map(b => [b.term, new Date(b.savedAt).toLocaleDateString()]);
            
            const csv = [headers, ...rows].map(row => row.map(cell => `"${cell}"`).join(',')).join('\n');
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `impactlex-bookmarks-${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            URL.revokeObjectURL(url);
            
            showToast('Bookmarks exported');
        }
        
        function clearAllBookmarks() {
            if (bookmarks.length === 0) return;
            
            if (confirm('Are you sure you want to clear all bookmarks?')) {
                bookmarks = [];
                localStorage.setItem('impactlex-bookmarks', '[]');
                updateBookmarkBadge();
                renderBookmarks();
                showToast('All bookmarks cleared');
            }
        }
        
        // ============================================================
        // SHARE
        // ============================================================
        function shareTerm() {
            if (!currentTerm) return;
            
            const shareData = {
                title: `ImpactLex: ${currentTerm.term}`,
                text: `Learn about "${currentTerm.term}" in the ImpactLex development sector dictionary`,
                url: window.location.href
            };
            
            if (navigator.share) {
                navigator.share(shareData).catch(() => {});
            } else {
                // Fallback: copy to clipboard
                navigator.clipboard.writeText(`${shareData.title}\n${shareData.text}\n${shareData.url}`);
                showToast('Link copied to clipboard');
            }
        }
        
        // ============================================================
        // TERM OF THE DAY
        // ============================================================
        function showTermOfDay() {
            // Use date as seed for consistent daily selection
            const today = new Date();
            const seed = today.getFullYear() * 10000 + (today.getMonth() + 1) * 100 + today.getDate();
            const index = seed % GLOSSARY_DATA.length;
            const term = GLOSSARY_DATA[index];
            
            document.getElementById('todTitle').textContent = term.term;
            document.getElementById('todPreview').textContent = term.definition.substring(0, 150) + '...';
            
            window.termOfDayId = term.id;
        }
        
        function openTermOfDay() {
            if (window.termOfDayId) {
                openTermModal(window.termOfDayId);
            }
        }
        
        // ============================================================
        // STATS
        // ============================================================
        function updateStats() {
            document.getElementById('statTerms').textContent = GLOSSARY_DATA.length;
            document.getElementById('statFormulae').textContent = FORMULAE_DATA.length;
            document.getElementById('statCases').textContent = CASE_STUDIES_DATA.length;
        }
        
        // ============================================================
        // TOAST NOTIFICATIONS
        // ============================================================
        function showToast(message) {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.innerHTML = `
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                    <polyline points="22 4 12 14.01 9 11.01"/>
                </svg>
                ${message}
            `;
            container.appendChild(toast);
            
            setTimeout(() => {
                toast.classList.add('hiding');
                setTimeout(() => toast.remove(), 300);
            }, 2500);
        }
        
        // ============================================================
        // PWA
        // ============================================================
        let deferredPrompt;
        
        function initPWA() {
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                
                // Show install banner if not dismissed
                if (!localStorage.getItem('impactlex-install-dismissed')) {
                    document.getElementById('installBanner').classList.add('visible');
                }
            });
            
            // Register service worker
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('sw.js').catch(() => {});
            }
        }
        
        function installApp() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choice) => {
                    if (choice.outcome === 'accepted') {
                        showToast('App installed successfully!');
                    }
                    deferredPrompt = null;
                    document.getElementById('installBanner').classList.remove('visible');
                });
            }
        }
        
        function dismissInstall() {
            localStorage.setItem('impactlex-install-dismissed', 'true');
            document.getElementById('installBanner').classList.remove('visible');
        }
        
        // ============================================================
        // MATH RENDERING
        // ============================================================
        function renderMath() {
            if (typeof renderMathInElement === 'function') {
                renderMathInElement(document.body, {
                    delimiters: [
                        {left: '$$', right: '$$', display: true},
                        {left: '$', right: '$', display: false}
                    ]
                });
            }
        }
    </script>
</body>
</html>
